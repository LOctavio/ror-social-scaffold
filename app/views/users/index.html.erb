<section class="users-section">
  <ul class="users-list">
    <% @users.each do |user| %>
      <li>
        Name: <%= user.name %>
        <span class="profile-link">
          <%= link_to 'See Profile',  user_path(user), class: 'profile-link' %>
          
          <% if user.id != current_user.id && !current_user.friend?(user)%>
            <span> | </span>
            <% pending_friend = current_user.pending_friends.find { |friend| friend.id == user.id } %>
            <% if user.friend_requests %>
              <span>accept</span>
            <% else %>
              <% if pending_friend %> 
                <%= button_to 'Pending', user_path(user), :disabled => true %> 
              <% else %> 
                <%= button_to "Add friend", friendships_path(friend_id: @user, user_id: current_user), method: 'post' %> 
              <% end %>
            
            <% end %>
          <% end %>
        </span>
      </li>
    <% end %>
  </ul>
</section>
